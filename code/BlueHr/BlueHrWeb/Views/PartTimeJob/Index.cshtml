@using MvcPaging
@using BlueHrWeb.Helpers.View
@model IPagedList<BlueHrLib.Data.PartTimeJob>

@{
    ViewBag.Title = "员工兼职管理";
}
@{
    bool canCreate = MenuAuthHelper.CanShow("PartTimeJob", "Create");
    bool canEdit = MenuAuthHelper.CanShow("PartTimeJob", "Edit");
    bool canDelete = MenuAuthHelper.CanShow("PartTimeJob", "Delete");
}

<ol class="breadcrumb current-position" style="margin-top:10px;">
    您的位置：
    <li>人事信息管理</li>
    <li>
        <strong>兼职管理</strong>
    </li>
</ol>

<hr class="hr-grey" />

<div class="search">
    <form action="/PartTimeJob/Search" method="get">
        <div class="row" style="margin:0;">
            <div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
                <div class="marco-igroup-primary">
                    <span>工号</span>

                    <input type="text" name="staffNr" id="staffNr" placeholder="工号" value="@ViewBag.Query.staffNr" />
                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-6 col-xs-6" style="margin-top:5px;">
                <button type="submit" class="marco-btn-success">
                    <i class="glyphicon glyphicon-search"></i>
                    搜索
                </button>
            </div>
        </div>
    </form>
</div>
<hr class="hr-primary" />
<div style="margin:10px;">
    <div class="minitor-show marco-tabs-default">
        @if (canCreate)
        {
        <a href="/PartTimeJob/Create" class="pull-right" style="margin-top: -10px;">
            <button class="marco-btn-primary">
                <i class="glyphicon glyphicon-plus-sign"></i>
                <span>创建</span>
            </button>
        </a>
        }

        <ul class="nav nav-tabs" role="tablist" style="width: 400px;">
            <li role="presentation" class="active"><a href="#current_PartTimeJob" role="tab" data-toggle="tab">当前兼职记录</a></li>
            <li role="presentation"><a href="#history_PartTimeJob" role="tab" data-toggle="tab">历史兼职记录</a></li>
        </ul>
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane  active" id="current_PartTimeJob">
                <div id="current_PartTimeJob_grid_table"></div>
                <table class="table table-bordered" style="display:none;">
                    <thead>
                        <tr>
                            <th>员工号</th>
                            <th>公司</th>
                            <th>部门</th>
                            <th>职位</th>
                            <th>开始日期</th>
                            <th>终止日期</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model != null)
                        {
                            foreach (var item in Model)
                            {
                                if(!item.isDelete){
                                    <tr>
                                        <td>
                                            <a href="/Staff/Delete/@item.staffNr" class="option-icon-primary" title="员工详情">
                                                @Html.DisplayFor(modelItem => item.staffNr)
                                                <i class="fa fa-eye"></i>
                                            </a>
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.CompanyName)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.DepartmentName)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.JobTitleName)
                                        </td>
                                        <td>
                                            @(@item.startTime.HasValue ? @item.startTime.Value.ToString("yyyy-MM-dd") : "")
                                        </td>
                                        <td>
                                            @(@item.endTime.HasValue ? @item.endTime.Value.ToString("yyyy-MM-dd") : "")
                                        </td>
                                        <td>
                                            @if (canDelete)
                                            {
                                                <a href="/PartTimeJob/Delete/@item.id" class="option-icon-primary" title="详情">
                                                    <i class="fa fa-eye"></i>
                                                </a>
                                            }
                                            @if (canEdit)
                                            {
                                            <a href="/PartTimeJob/Edit/@item.id" class="option-icon-warning" title="编辑">
                                                <i class="fa fa-pencil"></i>
                                            </a>
                                            }
                                        </td>
                                    </tr>
                                }
                            }
                        }
                    </tbody>
                </table>
            </div>
            <div role="tabpanel" class="tab-pane" id="history_PartTimeJob">
                <div id="history_PartTimeJob_grid_table"></div>
                <table class="table table-bordered" style="display:none;">
                    <thead>
                        <tr>
                            <th>员工号</th>
                            <th>公司</th>
                            <th>部门</th>
                            <th>职位</th>
                            <th>开始日期</th>
                            <th>终止日期</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model != null)
                        {
                            foreach (var item in Model)
                            {
                                if(item.isDelete){
                                    <tr>
                                        <td>
                                            <a href="/Staff/Delete/@item.staffNr" class="option-icon-primary" title="员工详情">
                                                @Html.DisplayFor(modelItem => item.staffNr)
                                                <i class="fa fa-eye"></i>
                                            </a>
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Company.name)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Department.name)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.JobTitle.name)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.startTime)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.endTime)
                                        </td>
                                        <td>
                                            @if (canDelete)
                                            {
                                                <a href="/PartTimeJob/Delete/@item.id" class="option-icon-primary" title="详情">
                                                    <i class="fa fa-eye"></i>
                                                </a>
                                            }
                                            @if (canEdit)
                                            {
                                                <a href="/PartTimeJob/Edit/@item.id" class="option-icon-warning" title="编辑">
                                                    <i class="fa fa-pencil"></i>
                                                </a>
                                            }
                                        </td>
                                    </tr>
                                }
                            }
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    Layout.init();

    //命名ID需要进行修改

    var TableWidth = $(window).width() - 300;
    if($.cookie('left_sidebar')=="true"){
        TableWidth = $(window).width() -110;
    }
    $(window).resize(function () {
        Layout.TransferTableToGrid(TableWidth, $(window).height() - 250, false, "current_PartTimeJob", "当前兼职记录列表", "20", "current_PartTimeJob_grid_table");
        Layout.TransferTableToGrid(TableWidth, $(window).height() - 250, false, "history_PartTimeJob", "历史兼职记录列表", "20", "history_PartTimeJob_grid_table");

    })
    Layout.TransferTableToGrid(TableWidth, $(window).height() - 250, false, "current_PartTimeJob", "当前兼职记录列表", "20", "current_PartTimeJob_grid_table");
    
    $('#history_PartTimeJob').addClass("active");
    Layout.TransferTableToGrid(TableWidth, $(window).height() - 250, false, "history_PartTimeJob", "历史兼职记录列表", "20", "history_PartTimeJob_grid_table");
    $('#history_PartTimeJob').removeClass("active");
    
</script>